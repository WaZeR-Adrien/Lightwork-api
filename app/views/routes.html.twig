{% extends 'layouts/main.html.twig' %}

{% block body %}

    <div id="reference" class="row page grey lighten-3 grey-text text-darken-4">

        {% for key, routes in refs|ksort %}
            <div id="{{ key }}" class="col s12">
                <h4 class="col s6 bold-text">
                    {{ key|capitalize }}
                </h4>
                <hr class="col s6 grey darken-4">
            </div>

            {% for route in routes %}
                <div class="col s12">
                    <div class="col s6 about">
                        <div class="col s12 white-text semibold-text method-and-endpoint {{ route.method|lower }}">
                            <span class="z-depth-2 method {{ route.method|lower }}">{{ route.method }}</span> /{{ route.path }}

                            {% if route.token %}
                                <i class="material-icons right tooltipped" data-position="right" data-tooltip="Secure route by Token">lock</i>
                            {% endif %}
                        </div>

                        {% if route.codes|length > 0 %}
                            <div class="col s12 errors">
                                <h6>Codes of response :</h6>

                                <table class="highlight">

                                    <thead>
                                    <tr>
                                        <th class="col s2">Code</th>
                                        <th class="col s2">Status</th>
                                        <th class="col s8">Message</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for code, content in route.codes %}
                                        <tr class="{{ code|first == 'S' ? 'green' : 'red' }} lighten-4">
                                            <td class="col s2">{{ code }}</td>
                                            <td class="col s2">{{ content.status }}</td>
                                            <td class="col s8">{{ content.message }}</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        {% endif %}
                    </div>

                    <div class="col s6 examples grey-text text-lighten-3 grey darken-4">
                        <h5 class="col s12 truncate">
                            {{ route.name }}
                        </h5>

                        <div class="col s12 request">
                            <h6>Request :</h6>

                            <p class="purple-text text-lighten-1"><i>Header</i></p>
                            <table class="highlight">

                                <thead>
                                <tr>
                                    <th>Key</th>
                                    <th>Value</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>Content-Type</td>
                                    <td>application/x-www-form-urlencoded</td>
                                </tr>
                                {% if route.token %}
                                <tr>
                                    <td>X-Auth-Token</td>
                                    <td>YOUR_TOKEN_HERE</td>
                                </tr>
                                {% endif %}
                                </tbody>
                            </table>

                            <p class="purple-text text-lighten-1"><i>{{ route.args|length > 0 ? 'Arguments' : 'No arguments' }}</i></p>
                            {% if route.args|length > 0 %}
                                <table class="highlight">

                                    <thead>
                                    <tr>
                                        <th>Key</th>
                                        <th>Type</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for keyArg, content in route.args %}
                                        <tr>
                                            <td>{{ keyArg }}</td>
                                            <td>{{ content.type }}</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            {% endif %}

                            <p class="purple-text text-lighten-1"><i>{{ route.bodies|length > 0 ? 'Bodies' : 'No bodies' }}</i></p>
                            {% if route.bodies|length > 0 %}
                                <table class="highlight">

                                    <thead>
                                    <tr>
                                        <th>Key</th>
                                        <th>Type</th>
                                        <th>Require</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for keyBody, content in route.bodies %}
                                        <tr>
                                            <td>{{ keyBody }}</td>
                                            <td>{{ content.type == '' ? 'All' : content.type|capitalize }}</td>
                                            <td>{{ content.required ? 'Require' : 'Optional' }}</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            {% endif %}
                        </div>

                        <div class="col s12 response">
                            <h6>Response :</h6>

                            <p class="purple-text text-lighten-1"><i>Header</i></p>
                            <table class="highlight">

                                <thead>
                                <tr>
                                    <th>Key</th>
                                    <th>Value</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>Content-Type</td>
                                    <td>{{ route.render == "json" ? "application" : "text" }}/{{ route.render }}</td>
                                </tr>
                                </tbody>
                            </table>

                            <div class="center-align" style="margin-top:20px;">
                                <a href="https://www.getpostman.com/run-collection/{{ g_postman_collection_id }}" target="_blank"><img src="https://run.pstmn.io/button.svg" alt="Run in Postman"></a>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% endfor %}

    </div>

    <script>
        $(document).ready(function () {
            // Init side nav
            $('.sidenav').sidenav({
                draggable: true
            });

            // Init  collapsible
            $('.collapsible').collapsible();

            // Init tooltip
            $('.tooltipped').tooltip()
        })
    </script>
{% endblock %}
